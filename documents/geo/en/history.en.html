<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<TITLE>COM Meets Ruby</TITLE>
</HEAD>
<body bgcolor="#FFFFFF">
<h3>Update Information</h3>
<address>9 Sep. 2006, 16:29:31 JST</address>
<ul>
  <li>ruby 1.8.5 with rjb-1.0.0, and ASR</li>
</ul>
<address>25 Dec. 2005, 04:14:23 JST</address>
<ul>
  <li>ruby 1.8.4 with rjb-0.2.5, and ASR</li>
</ul>
<address>29 Dec. 2004, 18:08:31 JST</address>
<ul>
  <li>ruby 1.8.2 with openssl.so, rjb-0.1.7, and ASR</li>
</ul>
<br>
<address>10 Jun. 2004, 13:12:18 JST</address>
<ul>
  <li>distribute source for ruby1.8 (I forgot to maintain the link).</li>
</ul>
<address>11 Mar. 2004, 21:29:20 JST</address>
<ul>ActiveScriptRuby 1.8.1.1
  <li>VRSWin040306</li>
  <li>vruby040306</li>
  <li>Win32OLE(patch with ruby-list:39157-)</li>
  <li>adding lib/ruby/1.8/test/ui/vrtestrunner.rb<br>
      for using vrtestrunner, you should patch below, and run with <code>-rv</code> or <code>--runner=vruby</code>
<pre>
--- ..\ruby-1.8.1\lib\test\unit\autorunner.rb	Wed Dec 24 16:17:38 2003
+++ c:\home\ruby\lib\ruby\1.8\test\unit\autorunner.rb	Fri Jan 16 00:32:32 2004
@@ -35,6 +35,10 @@
           require 'test/unit/ui/tk/testrunner'
           Test::Unit::UI::Tk::TestRunner
         end,
+        :vruby => proc do |r|
+          require 'test/unit/ui/vr/testrunner'
+          Test::Unit::UI::VRuby::TestRunner
+        end,
       }
 
       OUTPUT_LEVELS = [
</pre>
  </li>
</ul>

<address>17 Jan. 2004, 13:59:41 JST</address>
<ul>
 <li>I made a <a href="vrtestrunner.zip">testrunner</> class with VisualuRuby.</li>
</ul>
<address>29 Dec. 2003, 02:51:03 JST</address>
<ul>
 <li>Ruby 1.8.1 with fixed ReadLine.</li>
</ul>
<address>24 Jul. 2003, 22:11:15 JST</address>
<ul>
 <li>Adding <a href="wsc.html">wsc sample</a>.</li>
</ul>  
<address>25 Dec. 2002, 19:46:00 JST</address>
<ul>ActiveScriptRuby Version 1.6.8.0
  <li>VRuby, Swin, optparse, uconv, Racc, RubyWin were updated.
</ul>
<address>3 Mar. 2002, 00:29:35 JST</address>
<ul>ActiveScriptRuby Version 1.6.7.0
  <li>adding uconv, rubyunit.
  <li>VRuby, Racc, RDtool were updated.
</ul>
<br>
WOw! I found DotNet class is very useful to port ruby on the .NET, because it's very easy to check the functionality of the .NET Framework classes.<br>
For example, now I'm battling with System.IO.Path, System.Environment etc... for implementing 'require' function and so on.
<pre>
using 'System.IO'
Path = DotNet.new('Path')
p Path.IsPathRooted('\text.txt')
p Path.IsPathRooted('..\text.txt')
p Path.IsPathRooted('text.txt')
p "-----------------------"
p Path.GetDirectoryName('c:\windows\system32\notepad.exe')
p Path.GetFileName('c:\windows\notepad.exe')
p Path.GetExtension('c:\windows\notepad.exe')
</pre>
But, the method name 'new' was bad choice, so I'll change it to new_class or define_class soon.
<br>
<address>23 Feb. 2002, 22:54:45 JST</address>
<ul>ActiveScriptRuby Version 1.6.6.1 (not changed)
 <li><a href="nrb.html">snapshot update</a>
 <li>fix derived class path
 <li>fix function call with scope object
 <li>Thread added
 <li>Time added (not completed)
 <li>multithread host environment added (see samples in the archive)
</ul>
<address>17 Feb. 2002, 13:40:24 JST</address>
<ul>ActiveScriptRuby Version 1.6.6.1 (not changed)
 <li><a href="nrb.html">snapshot update</a>
 <li>fix Scope, Frame and Block relations.
 <li>fix classpath
 <li>add Proc
 <li>fix GVar assign
 <li>fix exceptional message and backtrace
</ul>
<address>10 Feb. 2002, 04:32:29 JST</address>
<ul>ActiveScriptRuby Version 1.6.6.1 (not changed)
 <li><a href="nrb.html">Status Update for NETRuby</a>
</ul>
<address>2 Feb. 2002, 11:57:21 JST</address>
<ul>ActiveScriptRuby Version 1.6.6.1
 <li>Ruby 1.6.6
 <li>ActiveScriptRuby(RScript.DLL and GRScript.DLL) 1.0.9.1
 <li>Win32OLE 0.3.4
 <li><a href="nrb.html">Status Update for NETRuby</a>
</ul>
<address>18 Dec. 2001, 23:10:37 JST</address>
<ul>ActiveScriptRuby Version 1.6.5.7
 <li>Ruby 1.6.5
 <li>ActiveScriptRuby(RScript.DLL and GRScript.DLL) 1.0.9.1
 <li>Support IActiveScriptParseProcedure for elements without ID attribute.
</ul>
<address>15 Dec. 2001, 13:39:41 JST</address>
<ul>ActiveScriptRuby Version 1.6.5.5
 <li>Ruby 1.6.5
 <li>ActiveScriptRuby(RScript.DLL and GRScript.DLL) 1.0.8.9
 <li>fix failed to invoke method directly with no typelib objects.
 <li>The source archive is now 1.0.8.10 for support DISPID_VALUE and DISPATCH_METHOD for the Befavior event.
</ul>
<address>12 Dec. 2001, 22:50:32 JST</address>
<ul>ActiveScriptRuby Version 1.6.5.4
 <li>Ruby 1.6.5
 <li>ActiveScriptRuby(RScript.DLL and GRScript.DLL) 1.0.8.8
 <li>fix outprocess server staying as zombie problem on HTA.
 <li>Racc, VRSwin, Optparser and more are updated.
</ul>
<address>20 Sep. 2001, 23:39:04 JST</address>
<ul>ActiveScriptRuby Version 1.6.5.0
 <li>Ruby 1.6.5
 <li>Win32OLE Early Binding (olegen.rb and Win32OLE 0.3.0) is something better for Dual interface object.
</ul>
<address>11 Aug. 2001, 01:58:08 JST</address>
<ul>ActiveScriptRuby Version 1.6.4.6
 <li>Ruby 1.6.4
 <li>RScript16 and GRScript16 were changed due to optional parameters while invoking methods.
</ul>
<address>1 Aug. 2001, 23:50:14 JST</address>
<ul>ActiveScriptRuby Version 1.6.4.4
 <li>Ruby 1.6.4
 <li>change download page's URL
</ul>
<address>6 Jun. 2001, 22:10:23 JST</address>
<ul>ActiveScriptRuby Version 1.6.4.0
 <li>Ruby 1.6.4
 <li>SWin and VRuby -> 010601/010603
 <li>dRuby 1.3.2
 <li>If you love MS technology and can read Japanese, please visit my <a href="http://www.geocities.co.jp/SiliconValley-PaloAlto/9251/ruby/netruby.html">NETRuby for .NET page</a>. C# sources are available but pre-alpha level.
</ul>
<address>3 May. 2001, 17:12:40 JST</address>
<ul>ActiveScriptRuby Version 1.6.3.5
 <li>SWin and VRuby -> 010428
</ul>
<address>22 Apr. 2001, 22:46:52 JST</address>
<ul>ActiveScriptRuby Version 1.6.3.4
 <li>RScript16, GRScript16 -> 1.0.8.4
 <li>Change eval scheme with 3 parameters to check line number by Ruby itself.
</ul>
<address>18 Apr. 2001, 22:41:47 JST</address>
<ul>ActiveScriptRuby Version 1.6.3.3 (not changed)
 <li>fix typo simpl -> simple, thanks Rob !
</ul>
<address>15 Apr. 2001, 22:37:44 JST</address>
<ul>ActiveScriptRuby Version 1.6.3.3
 <li>Built with VC++SP5
 <li>RubyWin 0.0.3.1
 <li>Racc 1.3.9
 <li>VRuby010409
</ul>
<address>28 Mar. 2001, 20:51:28 JST</address>
<ul>ActiveScriptRuby Version 1.6.3.1
 <li>add rbconf.rb
 <li>add BigFloat 1.1.6 by Shigeo Kobayashi.
</ul>
<address>20 Mar. 2001, 17:34:28 JST</address>
<ul>20 Mar. 2001, 17:34:28 JST, ActiveScriptRuby Version 1.6.3.0
 <li>RScript16/GRScript16 1.0.8.3/1.0.8.3
  <ul>
   <li>Now you can get the result of [in,out]VARIANT* from WIN32OLE::ARGV.
   <li>The component has a method as
     <pre>
        HRESULT foo([in,out]VARIANT* pBar);
     </pre>
     You can get the result as
     <pre>
     comp = WIN32OLE.new("FooBar")
     comp.foo 128
     if WIN32OLE::ARGV[0] != 128
       printf "New Bar = %d\n", WIN32OLE::ARGV[0]
     end
     </pre>
  </ul>
 <li>Ruby 1.6.3
</ul>
<address>14 Mar. 2001, 01:11:21 JST</address>
<ul>14 Mar. 2001, 01:11:21 JST, ActiveScriptRuby Version 1.6.2.10
 <li>RScript16/GRScript16 1.0.8.1/1.0.8.0
  <ul>
   <li>Correct Engine's reference count for IIS4.5.
   <li>Check the context of the Ruby thread when InterruptThread was called.
  </ul>
 <li>RubyWin 0.0.3.0
</ul>
<address>21 Jan. 2001, 00:53:06 JST</address>
<ul>21 Jan. 2001, 00:53:06 JST, ActiveScriptRuby Version 1.6.2.6
 <li>RScript16/GRScript16 1.0.8.0
 <li>Add rubyize sample
 <li>Win32OLE 0.0.9
 <li>Racc 1.3.5
</ul>
<address>16 Jan. 2001, 00:47:27 JST</address>
<ul>16 Jan. 2001, 00:47:27 JST, ActiveScriptRuby Version 1.6.2.5
 <li>Correct Win32OLE Unarray.
 <li>RubyWin 0.0.2.3
</ul>
<address>13 Jan. 2001, 17:40:23 JST</address>
<ul>13 Jan. 2001, 17:40:23 JST, ActiveScriptRuby Version 1.6.2.4
 <li>RScript16.dll 1.0.7.6, GRScript16.dll 1.0.7.6
 <li>I fixed bug caused bad C&amp;P in CRScriptCore::FinalRelease, this bug was found by Mr.Bloem, thanks Berrie !
 <li>I changed UNTRUSTED_DATA security level. From this version, you can't call system() in Internet Explorer anymore (also at My Computer. You must use HTA).
 <li>Add some WIN32OLE function. (not general win32ole.so, ActiveScriptRuby's implementation only)
  <ul>
   <li>WIN32OLE#__release
    <ul>
     <li>with this instance method __release (two underscore), you can explicitly call IUnknown::Release().
     <li>Beaware, this method makes SEGV easily.
    </ul>
    <pre>
      obj = WIN32OLE.new "foo.bar"
      obj.foo        # valid WIN32OLE object
      obj.__release  # after this call, obj is a empty WIN32OLE object
      obj.bar        # Bang! you got a SEGV
    </pre>
   <li>WIN32OLE::connect
    <ul>
      <li>I add capability to call New moniker. ("new:" is lower case)
      <pre>
        obj = WIN32OLE.connect "new:{812DF40E-XXXX-11D0-XXXX-00XXXXXXXXXX}"
            or
        obj = WIN32OLE.connect "new:foo.bar"
      </pre>
    </ul>
  </ul>
</ul>
<address>11 Jan. 2001, 20:53:39 JST</address>
<ul>11 Jan. 2001, 20:53:39 JST, ActiveScriptRuby Version 1.6.2.3
 <li>RScript16.dll 1.0.7.5
 <li>I fixed bug that ignores EnabledOption for IObjectSafety::SetIntefaceSafetyOptions.
 <li>Now you can create any ActiveX control in the context of Microsoft Script Control with UseSafeSubset = False.
</ul>
<address>10 Jan. 2001, 02:59:48 JST</address>
<ul>10 Jan. 2001, 03:01:29 JST, ActiveScriptRuby Version 1.6.2.2
 <li>RScript16.dll 1.0.7.4
 <li>Now you can run Windows Script Host using WSF format.
</ul>
<address>07 Jan. 2001, 17:18:26 JST</address>
<ul>07 Jan. 2001, 17:18:26 JST, ActiveScriptRuby Version 1.6.2.1
 <li>Add amine's Racc
 <li>Add Tosh's RDtool
 <li>Ruby is plain 1.6.2
 <li>RubyWin is 0.0.2.2
</ul>
<address>29 Dec. 2000, 18:46:44 JST</address>
<ul>29 Dec. 2000, 18:46:44 JST, ActiveScriptRuby Version 1.6.2.0
 <li>Add Mr.Nyasu's VR001229
 <li>Sub amine's Racc (but, It may return, soon)
 <li>Sub RubyCRT.DLL
 <li>Add MSVCRT.DLL and MSVCP60.DLL
 <li>Ruby is 1.6.2
 <li>RubyWin is 0.0.2.2
</ul>
<address>1 Nov. 2000, 00:26:29 JST</address>
<ul>31 Oct. 2000 21:18:05 ActiveScriptRuby Version 1.6.0.4
 <li>Add patch [ruby-dev:11312]
 <li>Add MR.Nyasu's SWin001022 ext.library
</ul>
<address>28 Oct. 2000, 0:58:47 JST</address>
<ul>ActiveScriptRuby Version 1.6.0.3
 <li>I implemented IMessageFilter in RScript16.DLL, so LRPC layer check the reentrance.
 <li>RubyWin is now linked statically.
 <li>I used Visual Installer update fearture. So, from this release, you never need to uninstall the package before you install newer one.
</ul>
<address>22 Oct. 2000, 23:20:32 JST</address>
<ul>22 Oct. 2000, ActiveScriptRuby Version 1.6.0.2
 <li>I rewrite sources to using IMessageFilter for nested reentrant cheking.
 <li>Also, I use -DNT for importing right value.
</ul>
<address>9 Oct. 2000, 20:05:41 JST</address>
<ul>9 Oct. 2000, ActiveScriptRuby Version 1.6.0.1
 <li>I Moved the download page from geocities.co.jp to graffiti.net
 <li>ActiveScriptRuby now bundled with Mr.Suketa's great RubyWin !
 <li>ugly file extension conversion is not required anymore.
</ul>
<address>29 Sep. 2000, 23:27:15 JST</address>
<ul>29 Sep. 2000, ActiveScriptRuby Version 1.6.0.0
 <li>ActiveScriptRuby itself was changed due to 1.6 naming conversion.
 <li>Ruby is now 1.6.1 with RubyCRT.DLL version. Due to Windows2000 env.
 <li>Adding few samples.
</ul>
<address>26 Aug. 2000, 09:47:00 JST</address>
<ul>26 Aug. 2000, ActiveScriptRuby Version 1.0.0.9
 <li>ActiveScriptRuby itself is not changed in this package.
 <li>Ruby is now 1.4.6 with RubyCRT.DLL version. Due to Windows2000 env.
 <li>Adding few samples.
</ul>
<address>22 Jun. 2000, 02:01:00 JST</address>
<ul>22 Jul. 2000, ActiveScriptRuby Version 1.0.0.7
 <li>ActiveScriptRuby is almost completed.
 <li>Adding Trace disable future for perfromance reason.
 <li>You can disable trace by "ActiveScriptRuby.settrace false"
 <li>But this makes the error information's line number useless.
</ul>
<address>17 Jul. 2000, 21:05:10 JST</address>
<ul>17 Jul. 2000, ActiveScriptRuby Version 1.0.0.6
 <li>I moved the installation page to geocities.co.jp for FreeServers 500K limit problem.
 <li>ActiveScriptRuby is almost completed.
 <li>I just start to investigate to support IActiveScriptDebug, but planed on late summer.
</ul>
<address>18 Jun. 2000, 18:35:00 JST</address>
<ul>18 Jun. 2000, RScript Version 1.0.4.0
 <li>I rewrote GlobalRubyScript.dll. For example Expanding wild cards, Supporting IActiveScript::InterruptScriptThread, excange objects between host and Ruby, etc.
 <li>If your ActiveScriptHost is only a Single Threaded Host, then, at this point, GlobalRubyScript is your companion.
 <li>I just start to investigate to support IActiveScriptDebug, but planed on late summer.
</ul>

<address>12 Jun. 2000, 03:05:32 JST</address>
<ul>12 Jun. 2000, RScript Version 1.0.3.2
 <li>Now ActiveScriptRuby support Internet Explorer's Security Option.<br>
     Ruby's dangerous operations are now ristricted in IE.
 <li>IActiveScript::InterruptScriptThread method was just Supported.
 <li>Now ActiveScriptRuby never overrides existing RUBYLIB environmental variable.
</ul>

<address>4 Jun. 2000, 00:39:10 JST</address>
<ul>3 Jun. 2000, RScript Version 1.0.2.5
 <li>Fix cannot create ActiveX control in HTA bug.<br>
     summary: typo.
 <li>Fix the host crush bug after abort by ScriptError.<br>
     summary: internal event receiver lifetime management problem.
 <li>Fix Update page bug in IE.<br>
     summary: Incorrect release for ActiveScriptHost Object's stub pointer.
</ul>

<p>
<address>22 Apr. 20000</address>
<ul>
 <li>RubyScript Now Checks the ActiveX Control Safety option.
 <li>Add C++ Sample (inspired by Nakamura, Hiroshi - thanks)
</ul>

<p>
<address>15 Apr. 2000</address>
First English Version<br>
RScript Version 1.0.2.3


<p>
<hr>
<p>
<a href="main.html">Top</a>
<p>
<address>copyright &#169; 2000, 2006 <a href="mailto:arton@geocities.co.jp">arton</a> under GPL</address>
<br>
</body>
</html>
